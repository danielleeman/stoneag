<!DOCTYPE html>
<html>
    <head>
        <title>loadMapAsyncHTML</title>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
    </head>
    <body>
        <div id='printoutPanel'></div>

        <div id='myMap' style='width: 100vw; height: 100vh;'></div>
        <script type='text/javascript'>
                var map;
                function loadMapScenario() {
                    var fieldGeo = [[46.65326757894689, -96.42025035713709],[46.652448813710876, -96.42023384116604],[46.65244575870562, -96.42093202940694],[46.653262927370356, -96.42127000481528]];
                    // var centerLat = 0;
                    // var centerLong = 0;
                    var polyPoints = [];
                    for (i = 0; i < fieldGeo.length; i++) {
                      var latitude = fieldGeo[i][0];
                      var longitude = fieldGeo[i][1];
                      var polyPoint = new Microsoft.Maps.Location(latitude,longitude);
                      polyPoints.push(polyPoint);
                      // centerLat += latitude;
                      // centerLong += longitude;
                    }
                    var polygon = new Microsoft.Maps.Polygon(polyPoints, null);
                    // centerLat = centerLat / fieldGeo.length;
                    // centerLong = centerLong / fieldGeo.length;
                    var geoCenter = Microsoft.Maps.LocationRect.fromLocations(polyPoints);
                    map = new Microsoft.Maps.Map(document.getElementById('myMap'), {
                      center : geoCenter.center,
                      zoom : 15
                    });
                    map.entities.push(polygon);
                }


        </script>
        <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AmEwuRcX-WzBU0avFXuaCuhaTf1ASEpB_jqey7d33YqgPHIDfcdiE4nSor_uAI6z&callback=loadMapScenario' async defer></script>
    </body>
</html>
